library(demogR)
methods(cdmltw)
methods(demoR::cdmltw)
methods(demogR::cdmltw)
demogR::cdmltw()?
l
?demogR::cdmltw()
?getMethod
getMethod(cdmltw)
getMethod("cdmltw")
cdmltw
cdmltn
cdmlte
cdmlts
?%o%
c(1, 2) * c(3, 4)
c(1, 2) %*% c(3, 4)
c(1, 2) %o% c(3, 4)
library(demogR)
this.dir <- dirname(parent.frame(2)$ofile) # r file must be "sourced" for this to work in RStudio
setwd(this.dir)
ages <- c(0.5, 1.5, 4, seq(8.5, 98.5, 5))
setwd("C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables")
west_raw <- t(cdmltw(sex = "F")$nqx)
View(west_raw)
?approx
west_1year <- data.frame()
for (i in 1:ncol(west_raw)) {
west_1year <- cbind(
west_1year,
approx(west_raw[,i], xout = 150, yleft = 0, yright = 1)
)
}
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(west_raw[,i], xout = 150, yleft = 0, yright = 1)
}
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
ages <- c(0.5, 1.5, 4, seq(8.5, 98.5, 5))
# West
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 150, yleft = 0, yright = 1)
}
View(west_raw)
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
ages <- c(0.5, 1.5, 4, seq(8.5, 92.5, 5))
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
ages <- c(0.5, 1.5, 4, seq(8.5, 98.5, 5))
ages
ages <- c(0.5, 1.5, 4, seq(8.5, 93.5, 5))
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 150, yleft = 0, yright = 1)
}
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
approx(ages, west_raw[, 1],
xout = 150, yleft = 0, yright = 1)
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(NA, nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 0:150, yleft = 0, yright = 1)
}
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(numeric(0), nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 0:150, yleft = 0, yright = 1)
}
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(numeric(0), nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
approx(ages, west_raw[, 1],
xout = 150, yleft = 0, yright = 1)
View(west_raw)
west_raw <- t(cdmltw(sex = "F")$nqx)
row.names(west_raw) <- ages
west_1year <- data.frame(matrix(numeric(0), nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
row.names(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 0:150, yleft = 0, yright = 1)
}
View(west_raw)
ages <- c(0.5, 1.5, 4, seq(8.5, 93.5, 5))
# West
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(numeric(0), nrow = nrow(west_raw), ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(numeric(0), nrow = 151, ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
View(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 0:150, yleft = 0, yright = 1)
}
approx(ages, west_raw[, 1],
xout = 0:150, yleft = 0, yright = 1)
ages <- c(0.5, 1.5, 4, seq(8.5, 93.5, 5))
# West
west_raw <- t(cdmltw(sex = "F")$nqx)
west_1year <- data.frame(matrix(numeric(0), nrow = 151, ncol = ncol(west_raw)))
names(west_1year) <- 1:ncol(west_1year)
for (i in 1:ncol(west_raw)) {
west_1year[, i] <- approx(ages, west_raw[, i],
xout = 0:150, yleft = 0, yright = 1)$y
}
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
interpolatePerYear <- function(raw, ages = c(0.5, 1.5, 4, seq(8.5, 93.5, 5))) {
perYear <- data.frame(matrix(numeric(0), nrow = 151, ncol = ncol(raw)))
names(perYear) <- 1:ncol(perYear)
for (i in 1:ncol(raw)) {
perYear[, i] <- approx(ages, raw[, i],
xout = 0:150, yleft = 0, yright = 1)$y
}
return(perYear)
}
library(demogR)
interpolatePerYear <- function(raw, ages = c(0.5, 1.5, 4, seq(8.5, 93.5, 5))) {
perYear <- data.frame(matrix(numeric(0), nrow = 151, ncol = ncol(raw)))
names(perYear) <- 1:ncol(perYear)
for (i in 1:ncol(raw)) {
perYear[, i] <- approx(ages, raw[, i],
xout = 0:150, yleft = 0, yright = 1)$y
}
return(perYear)
}
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
setwd("C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables")
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
cdmltw(sex = "F")$nqx
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/importCoaleDemenyLifeTables.R')
50 - 11
length(12:50)
fertile_ages <- 12:50
n_fertile_ages <- length(fertile_ages)
prob_birth <- c(
rep(0, 12),
dbeta((fertile_ages - 12) / n_fertile_ages, 2, 4),
rep(0, 49)
)
setwd("C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables")
prob_birth <- c(
rep(0, 12),
dbeta((fertile_ages - 12) / n_fertile_ages, 2, 4),
rep(0, 99)
)
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
plot(prob_birth[, 1])
source('C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables/generateBetaDistribution.R')
library(demogR)
interpolatePerYear <- function(raw, ages = c(0.5, 1.5, 4, seq(8.5, 93.5, 5))) {
perYear <- data.frame(matrix(numeric(0), nrow = 151, ncol = ncol(raw)))
names(perYear) <- 1:ncol(perYear)
for (i in 1:ncol(raw)) {
perYear[, i] <- approx(ages, raw[, i],
xout = 1:151, yleft = 0, yright = 1)$y
}
row.names(perYear) <- 0:150
return(perYear)
}
plot(interpolatePerYear(t(cdmltw(sex = "F")$nqx)))
plot(interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1])))
barplot(interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1])))
plot(1:150, interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1])))
plot(1:151, interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1])))
interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1]))
interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1]))
interpolatePerYear(t(cdmltw(sex = "F")$nqx))
x <- interpolatePerYear(t(cdmltw(sex = "F")$nqx))
plot(1:151, interpolatePerYear(t(cdmltw(sex = "F")$nqx[,1]))[,1])
plot(1:151, interpolatePerYear(t(cdmltw(sex = "F")$nqx))[,1])
setwd("C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables")
library(demogR)
# set parameters (for building dataset and plotting)
sex = "F"
level = 3
ageCohort = c(0, 1, seq(5, 95, by = 5))
submodel.col <- c("red", "green", "blue", "purple", "black")
submodels.pch <- c(1, 2, 3, 4, 5)
# build dataset
dt <- data.frame(
cbind(
cbind(ageCohort, rep("west",     21), cdmltw(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("east",     21), cdmlte(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("south",    21), cdmlts(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("north",    21), cdmltn(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("ext.data", 21), ext.dt[[sex]][,2])
))
names(dt) <- c("ageCohort", "submodel", "nqx")
dt$submodel <- factor(dt$submodel,
levels = c("west", "east", "south", "north", "ext.data"))
dt$ageCohort <- as.numeric(as.character(dt$ageCohort))
dt <- data.frame(
cbind(
ageCohort,
"west" = cdmltw(sex = sex)$nqx[level,],
"east" = cdmlte(sex = sex)$nqx[level,],
"south" = cdmlts(sex = sex)$nqx[level,],
"north" = cdmltn(sex = sex)$nqx[level,],
"ext.data" = ext.dt[[sex]][,2]
))
# plot
plot(dt$ageCohort, 0:max(dt[,2:ncol(dt)]),
type="n",
xlab = "age cohort", ylab = "mortality (nqx)")
for (v in 2:ncol(dt)) {
lines(dt$ageCohort,
dt[v],
col = submodel.col[v], pch=submodels.pch[v],
type = "b")
}
title(paste("Age-specific mortality rates (", sex, ", ", level, ")"))
legend(80, 40,
names(dt)[2:ncol(dt)],
col=submodel.col, pch=submodels.pch,
lty = 1,
title="submodel")
# build dataset
dt <- data.frame(
cbind(
cbind(ageCohort, rep("west",     21), cdmltw(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("east",     21), cdmlte(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("south",    21), cdmlts(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("north",    21), cdmltn(sex = sex)$nqx[level,]),
cbind(ageCohort, rep("ext.data", 21), ext.dt[[sex]][,2])
))
names(dt) <- c("ageCohort", "submodel", "nqx")
dt$submodel <- factor(dt$submodel,
levels = c("west", "east", "south", "north", "ext.data"))
dt$ageCohort <- as.numeric(as.character(dt$ageCohort))
dt <- data.frame(
cbind(
ageCohort,
"west" = cdmltw(sex = sex)$nqx[level,],
"east" = cdmlte(sex = sex)$nqx[level,],
"south" = cdmlts(sex = sex)$nqx[level,],
"north" = cdmltn(sex = sex)$nqx[level,]
#, "ext.data" = ext.dt[[sex]][,2]
))
# plot
plot(dt$ageCohort, 0:max(dt[,2:ncol(dt)]),
type="n",
xlab = "age cohort", ylab = "mortality (nqx)")
for (v in 2:ncol(dt)) {
lines(dt$ageCohort,
dt[v],
col = submodel.col[v], pch=submodels.pch[v],
type = "b")
}
title(paste("Age-specific mortality rates (", sex, ", ", level, ")"))
legend(80, 40,
names(dt)[2:ncol(dt)],
col=submodel.col, pch=submodels.pch,
lty = 1,
title="submodel")
read.table(paste("cdmltew", sex, ".txt"), sep = " ")[,level]
read.table(paste("cdmltew", sex, ".txt", sep = ""), sep = " ")[,level]
setwd("C:/Users/aa2112/OneDrive/Documentos/2_Simulation/abm-templates/3_householdDemography/demoTables")
read.table(paste("cdmltew", sex, ".txt", sep = ""), sep = " ")[,level]
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
dt <- data.frame(
cbind(
cbind(ageCohort, rep("west",     21),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("east",     21),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("south",    21),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("north",    21),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
dt <- data.frame(
cbind(
cbind(ageCohort, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
dt <- data.frame(
rbind(
cbind(ageCohort, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
sex = "F"
level = 3
ageCohort = 0:150
submodel.col <- c("red", "green", "blue", "purple", "black")
submodels.pch <- c(1, 2, 3, 4, 5)
# build dataset
dt <- data.frame(
rbind(
cbind(ageCohort, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
library(demogR)
#this.dir <- dirname(parent.frame(2)$ofile) # r file must be "sourced" for this to work in RStudio
#setwd(this.dir)
# load external data
# ext.dt <- list(
#   F = read.table("table_womenMortalityTable.txt", skip = 2, nrows = 21, sep = " "),
#   M = read.table("table_menMortalityTable.txt", skip = 2, nrows = 21, sep = " ")
# )
# set parameters (for building dataset and plotting)
sex = "F"
level = 3
age = 0:150
submodel.col <- c("red", "green", "blue", "purple", "black")
submodels.pch <- c(1, 2, 3, 4, 5)
# build dataset
dt <- data.frame(
rbind(
cbind(ageCohort, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ageCohort, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
names(dt) <- c("age", "submodel", "nqx")
library(demogR)
#this.dir <- dirname(parent.frame(2)$ofile) # r file must be "sourced" for this to work in RStudio
#setwd(this.dir)
# load external data
# ext.dt <- list(
#   F = read.table("table_womenMortalityTable.txt", skip = 2, nrows = 21, sep = " "),
#   M = read.table("table_menMortalityTable.txt", skip = 2, nrows = 21, sep = " ")
# )
# set parameters (for building dataset and plotting)
sex = "F"
level = 3
ages = 0:150
submodel.col <- c("red", "green", "blue", "purple", "black")
submodels.pch <- c(1, 2, 3, 4, 5)
# build dataset
dt <- data.frame(
rbind(
cbind(ages, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
names(dt) <- c("ages", "submodel", "nqx")
dt$submodel <- factor(dt$submodel,
levels = c("west", "east", "south", "north"))
dt$ages <- as.numeric(as.character(dt$ages))
sex = "F"
level = 3
ages = 0:150
submodel.col <- c("red", "green", "blue", "purple", "black")
submodels.pch <- c(1, 2, 3, 4, 5)
# build dataset
dt <- data.frame(
rbind(
cbind(ages, rep("west",     151),
read.table(paste("cdmltw", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("east",     151),
read.table(paste("cdmlte", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("south",    151),
read.table(paste("cdmlts", sex, ".txt", sep = ""), sep = " ")[,level]
),
cbind(ages, rep("north",    151),
read.table(paste("cdmltn", sex, ".txt", sep = ""), sep = " ")[,level]
)
))
names(dt) <- c("ages", "submodel", "nqx")
dt$submodel <- factor(dt$submodel,
levels = c("west", "east", "south", "north"))
dt$ages <- as.numeric(as.character(dt$ages))
dt$nqx <- as.numeric(as.character(dt$nqx))
plot(dt$ages, 0:max(dt[,2:ncol(dt)]),
type="n",
xlab = "age cohort", ylab = "mortality (nqx)")
for (v in 2:ncol(dt)) {
lines(dt$ages,
dt[v],
col = submodel.col[v], pch=submodels.pch[v],
type = "b")
}
title(paste("Age-specific mortality rates (", sex, ", ", level, ")"))
legend(80, 40,
names(dt)[2:ncol(dt)],
col=submodel.col, pch=submodels.pch,
lty = 1,
title="submodel")
# plot
plot(dt$ages, 0:max(dt$nqx),
type="n",
xlab = "age cohort", ylab = "mortality (nqx)")
0:max(dt$nqx)
dt$ages
